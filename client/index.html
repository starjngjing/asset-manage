<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>国槐金融资管系统</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://cdn.bootcss.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="plugins/bootstrap-table/bootstrap-table.css">
    <link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap-datetimepicker/4.15.35/css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="http://cdn.bootcss.com/iCheck/1.0.2/skins/minimal/blue.css"/>
    <link rel="stylesheet" href="http://cdn.bootcss.com/select2/4.0.2/css/select2.min.css">
    <link rel="stylesheet" href="http://cdn.bootcss.com/toastr.js/2.1.2/toastr.min.css">
    <link rel="stylesheet" href="assets/css/AdminLTE.min.css">
    <link rel="stylesheet" href="assets/css/skin-blue.min.css">
    <link rel="stylesheet" href="assets/css/main.css">

    <link rel="shortcut icon" href="favicon.ico" />
  </head>
  <body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">

      <header class="main-header">
        <!-- Logo -->
        <a href="javascript:void(0)" class="logo">
          <!-- mini logo for sidebar mini 50x50 pixels -->
          <span class="logo-mini">
            <img src="assets/images/logo.png" alt="国槐金融" class="logo-mini-img">
          </span>
          <!-- logo for regular state and mobile devices -->
          <span class="logo-lg">
            <img src="assets/images/logo.png" alt="国槐金融" class="logo-img">
          </span>
        </a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top" role="navigation">
          <!-- Sidebar toggle button-->
          <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <div class="navbar-custom-menu">
            <ul class="nav navbar-nav">
              <!-- User Account: style can be found in dropdown.less -->
              <li id="userMenu" class="dropdown user user-menu">
                <a href="javascript:void(0)" class="dropdown-toggle" data-toggle="dropdown">
                  <span class="hidden-xs userName"></span>
                </a>
              </li>
              <li>
                <a id="logout" href="javascript:void(0)" data-toggle="control-sidebar">
                  <i class="fa fa-sign-out"></i>
                </a>
              </li>
            </ul>
          </div>
        </nav>
      </header>
      <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar">
        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">
          <!-- search form -->
          <!--<form action="#" method="get" class="sidebar-form">-->
            <!--<div class="input-group">-->
              <!--<input type="text" name="q" class="form-control" placeholder="搜索导航栏">-->
              <!--<span class="input-group-btn">-->
                <!--<button type="submit" name="search" id="search-btn" class="btn btn-flat"><i class="fa fa-search"></i></button>-->
              <!--</span>-->
            <!--</div>-->
          <!--</form>-->
          <!-- /.search form -->
          <!-- sidebar menu: : style can be found in sidebar.less -->
          <ul id="sidebarMenu" class="sidebar-menu">
            <li class="header">运营管理</li>
            <li class="treeview">
              <a href="javascript:void(0)">
                <i class="fa fa-truck"></i>
                <span>渠道管理</span>
                <i class="fa fa-angle-left pull-right"></i>
              </a>
              <ul class="treeview-menu">
                <li>
                  <a href="javascript:void(0)" data-gh-route="channel">
                    <i class="fa fa-circle-o"></i> 全部渠道
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="channelapply">
                    <i class="fa fa-circle-o"></i> 渠道审批
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="channeldetail">
                    <i class="fa fa-circle-o"></i> 渠道详情
                  </a>
                </li>
              </ul>
            </li>
            <li class="treeview">
              <a href="javascript:void(0)">
                <i class="fa fa-building-o"></i>
                <span>投资标的管理</span>
                <i class="fa fa-angle-left pull-right"></i>
              </a>
              <ul class="treeview-menu">
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetApply">
                    <i class="fa fa-circle-o"></i> 标的申请管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetAccess">
                    <i class="fa fa-circle-o"></i> 标的会前审查
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetConvention">
                    <i class="fa fa-circle-o"></i> 标的过会管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetVote">
                    <i class="fa fa-circle-o"></i> 标的过会表决
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetStorage">
                    <i class="fa fa-circle-o"></i> 投资标的备选库
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetHold">
                    <i class="fa fa-circle-o"></i> 持仓标的管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetNotHold">
                    <i class="fa fa-circle-o"></i> 未持仓标的管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetHistory">
                    <i class="fa fa-circle-o"></i> 历史标的管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetCollect">
                    <i class="fa fa-circle-o"></i> 风险预警管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="targetHandle">
                    <i class="fa fa-circle-o"></i> 风险处置管理
                  </a>
                </li>
              </ul>
            </li>
            <li class="treeview">
              <a href="javascript:void(0)">
                <i class="fa fa-credit-card"></i>
                <span>现金类管理工具管理</span>
                <i class="fa fa-angle-left pull-right"></i>
              </a>
              <ul class="treeview-menu">
                <li>
                  <a href="javascript:void(0)" data-gh-route="cashtoolApply">
                    <i class="fa fa-circle-o"></i> 现金类管理工具申请
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="cashtoolAccess">
                    <i class="fa fa-circle-o"></i> 现金类管理工具审查
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="cashtoolStorage">
                    <i class="fa fa-circle-o"></i> 现金类管理工具备选库
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="cashtoolHistory">
                    <i class="fa fa-circle-o"></i> 历史现金类管理工具
                  </a>
                </li>
              </ul>
            </li>
            <li class="treeview">
              <a href="javascript:void(0)">
                <i class="fa fa-cubes"></i>
                <span>产品管理</span>
                <i class="fa fa-angle-left pull-right"></i>
              </a>
              <ul class="treeview-menu">
                <li>
                  <a href="javascript:void(0)" data-gh-route="productDesign">
                    <i class="fa fa-circle-o"></i> 产品申请管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="productAudit">
                    <i class="fa fa-circle-o"></i> 审核列表
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="productReview">
                    <i class="fa fa-circle-o"></i> 复核列表
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="productAccess">
                    <i class="fa fa-circle-o"></i> 产品准入管理
                  </a>
                </li>
              </ul>
            </li>
            <li class="treeview">
              <a href="javascript:void(0)">
                <i class="fa fa-tachometer"></i>
                <span>运营管理</span>
                <i class="fa fa-angle-left pull-right"></i>
              </a>
              <ul class="treeview-menu">
                <li>
                  <a href="javascript:void(0)" data-gh-route="AssetPool">
                    <i class="fa fa-circle-o"></i> 资产池管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="AssetPoolDuration">
                    <i class="fa fa-circle-o"></i> 资产池存续期管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="investor">
                    <i class="fa fa-circle-o"></i> 持有人名册管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="inputOrder">
                    <i class="fa fa-circle-o"></i> 未确认持有人订单管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="spvTrade">
                    <i class="fa fa-circle-o"></i> SPV交易管理
                  </a>
                </li>
              </ul>
            </li>
            <!--<li class="treeview">-->
              <!--<a href="javascript:void(0)">-->
                <!--<i class="fa fa-money"></i>-->
                <!--<span>资金管理</span>-->
                <!--<i class="fa fa-angle-left pull-right"></i>-->
              <!--</a>-->
              <!--<ul class="treeview-menu">-->
                <!--<li>-->
                  <!--<a href="javascript:void(0)">-->
                    <!--<i class="fa fa-circle-o"></i> 资金流管理-->
                  <!--</a>-->
                <!--</li>-->
                <!--<li>-->
                  <!--<a href="javascript:void(0)">-->
                    <!--<i class="fa fa-circle-o"></i> 备付金管理-->
                  <!--</a>-->
                <!--</li>-->
                <!--<li>-->
                  <!--<a href="javascript:void(0)">-->
                    <!--<i class="fa fa-circle-o"></i> 日常出入金管理-->
                  <!--</a>-->
                <!--</li>-->
              <!--</ul>-->
            <!--</li>-->
            <!--<li class="treeview">-->
              <!--<a href="javascript:void(0)">-->
                <!--<i class="fa fa-adn"></i>-->
                <!--<span>订单管理</span>-->
                <!--<i class="fa fa-angle-left pull-right"></i>-->
              <!--</a>-->
              <!--<ul class="treeview-menu">-->
                <!--<li>-->
                  <!--<a href="javascript:void(0)">-->
                    <!--<i class="fa fa-circle-o"></i> 销售平台订单管理-->
                  <!--</a>-->
                <!--</li>-->
              <!--</ul>-->
            <!--</li>-->
            <li class="treeview">
              <a href="javascript:void(0)">
                <i class="fa fa-book"></i>
                <span>会计分录</span>
                <i class="fa fa-angle-left pull-right"></i>
              </a>
              <ul class="treeview-menu">
                <li>
                  <a href="javascript:void(0)" data-gh-route="document">
                    <i class="fa fa-circle-o"></i> 凭证查询
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="bookBalance">
                    <i class="fa fa-circle-o"></i> 资产负债情况试算表
                  </a>
                </li>
              </ul>
            </li>
            <li class="header">系统设置</li>
            <li class="treeview">
              <a href="javascript:void(0)">
                <i class="fa fa-lock"></i>
                <span>权限管理</span>
                <i class="fa fa-angle-left pull-right"></i>
              </a>
              <ul class="treeview-menu">
                <li>
                  <a href="javascript:void(0)" data-gh-route="role">
                    <i class="fa fa-circle-o"></i> 角色管理
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="user">
                    <i class="fa fa-circle-o"></i> 用户管理
                  </a>
                </li>
              </ul>
            </li>
            <li class="treeview">
              <a href="javascript:void(0)">
                <i class="fa fa-cogs"></i>
                <span>风控引擎设置</span>
                <i class="fa fa-angle-left pull-right"></i>
              </a>
              <ul class="treeview-menu">
                <li>
                  <a href="javascript:void(0)" data-gh-route="ccpWarranty">
                    <i class="fa fa-circle-o"></i> 资产准入评分模型
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="riskIndicate">
                    <i class="fa fa-circle-o"></i> 风险关键指标维护
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="ccpRiskScore">
                    <i class="fa fa-circle-o"></i> 信用等级评分模型
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="ccpWarning">
                    <i class="fa fa-circle-o"></i> 风险预警等级模型
                  </a>
                </li>
              </ul>
            </li>
            <li class="treeview">
              <a href="javascript:void(0)">
                <i class="fa fa-calculator"></i>
                <span>会计分录设置</span>
                <i class="fa fa-angle-left pull-right"></i>
              </a>
              <ul class="treeview-menu">
                <li>
                  <a href="javascript:void(0)" data-gh-route="acctAccount">
                    <i class="fa fa-circle-o"></i> 科目设置
                  </a>
                </li>
                <li>
                  <a href="javascript:void(0)" data-gh-route="docTemplate">
                    <i class="fa fa-circle-o"></i> 凭证模板
                  </a>
                </li>
              </ul>
            </li>

          </ul>
        </section>
        <!-- /.sidebar -->
      </aside>

      <!-- Content Wrapper. Contains page content -->
      <div id="mainContent" class="content-wrapper"></div>

      <footer class="main-footer">
        <div class="pull-right hidden-xs">
          <b>Version</b> 0.1.0
        </div>
        <strong>Copyright &copy; 2015-2016 <a href="http://www.guohuaigroup.com">国槐金融</a> </strong> 版权所有
      </footer>
    </div><!-- ./wrapper -->

    <!-- jQuery 2.1.4 -->
    <script src="http://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <!-- Bootstrap 3.3.5 -->
    <script src="plugins/bootstrap/js/bootstrap.min.js"></script>
    <!-- Moment 2.10.6 -->
    <script src="http://cdn.bootcss.com/moment.js/2.10.6/moment.min.js"></script>
    <script src="http://cdn.bootcss.com/moment.js/2.10.6/locale/zh-cn.js"></script>
    <!-- jQuery-form -->
    <script src="plugins/jQuery-form/jquery.form.js"></script>
    <!-- icheck 1.0.2 -->
    <script src="http://cdn.bootcss.com/iCheck/1.0.2/icheck.min.js"></script>
    <!-- Select2 4.0.2 -->
    <script src="http://cdn.bootcss.com/select2/4.0.2/js/select2.min.js"></script>
    <script src="http://cdn.bootcss.com/select2/4.0.2/js/i18n/zh-CN.js"></script>
    <!-- toastr -->
    <script src="http://cdn.bootcss.com/toastr.js/2.1.2/toastr.min.js"></script>
    <!-- Bootstrap-table -->
    <script src="plugins/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
    <!-- treetable -->
    <script src="plugins/jQuery-treetable/jquery.treetable.js"></script>
    <!-- Datetimepicker -->
    <script src="http://cdn.bootcss.com/bootstrap-datetimepicker/4.15.35/js/bootstrap-datetimepicker.min.js"></script>
    <!-- validator -->
    <script src="plugins/bootstrap-validator/validator.js"></script>
    <!-- SlimScroll -->
    <script src="plugins/slimScroll/jquery.slimscroll.min.js"></script>
    <!-- FastClick -->
    <!--<script src="plugins/fastclick/fastclick.min.js"></script>-->
    <!-- Echarts 3.1.9 -->
    <script src="http://cdn.bootcss.com/echarts/3.1.9/echarts.common.min.js"></script>
    <!-- AdminLTE App -->
    <script src="assets/js/app.min.js"></script>
    <!-- requirejs -->
    <script src="http://cdn.bootcss.com/require.js/2.1.22/require.min.js"></script>

    <script>
      $(document).ready (function () {
        requirejs.config({
          baseUrl: 'assets/js',
          paths: {
            page: '../../pages'
          }
        })
        // 为满足断点调试需求，前期将资源全部require进来，$.getScript无法满足断点调试
        var navSource = [
          'channel',
          'channelapply',
          'channeldetail',
          'targetApply',
          'targetAccess',
          'targetConvention',
          'targetVote',
          'targetStorage',
          'cashtoolHistory',
          'targetHold',
          'targetNotHold',
          'targetHistory',
          'cashtoolApply',
          'cashtoolAccess',
          'cashtoolStorage',
          'productDesign',
          'productAudit',
          'productReview',
          'productAccess',
          'AssetPool',
          'AssetPoolDuration',
          'investor',
          'inputOrder',
          'spvTrade',
          'acctAccount',
          'docTemplate',
          'document',
          'bookBalance',
          'role',
          'user',
          'ccpWarranty',
          'riskIndicate',
          'ccpRiskScore',
          'ccpWarning',
          'targetCollect',
           'targetHandle'
        ]
        var navRequire = (function () {
          var arr = ['config', 'extension', 'http', 'util']
          navSource.forEach(function (item) {
            arr.push('page/' + item + '/' + item)
          })
          return arr
        })()

        requirejs(navRequire, function () {
          var requireModules = arguments
          var config = requireModules[0]
          var $$ = requireModules[1]
          var http = requireModules[2]
          var util = requireModules[3]

          // 获取hash，通过hash定位到当前页面，hash中 '?' 及以后的部分作为参数内容，不作为页面判断依据
          var hash = ''
          // 参数内容暂存在params中，仅在初次载入页面时有效，点击导航栏按钮切换页面后失效
          var params =  {
            value : ''
          }
          // currentHash用于存储点击后的hash，防止进行重复点击
          var currentHash = ''
          if (location.hash.indexOf('?') >= 0) {
            hash = location.hash.substring(1, location.hash.indexOf('?'))
            params.value = location.hash.substr(location.hash.indexOf('?') + 1)
          } else {
            hash = location.hash.substr(1)
          }
          /**
           * 左侧菜单点击load右侧页面初始化
           */
          $('#sidebarMenu')
            .find('[data-gh-route]')
            .on('click', function () {
              var route = $(this).attr('data-gh-route')
              if (route === currentHash) return
              $('#sidebarMenu').find('.active').removeClass('active')
              $(this).parent().addClass('active')
              $('#mainContent')
                .empty()
                .load('pages/' + route + '/' + route + '.html', function () {
                  for (var key in requireModules) {
                    if (requireModules[key].name === route) {
                      requireModules[key].init()
                    }
                  }
                  // 全局阻止form默认input焦点回车提交表单事件
                  $('form')
                    .find('input')
                    .on('focus', function () {
                      $(document).on('keydown.formInput', function (e) {
                        if (e.keyCode === 13) {
                          e.preventDefault()
                          return false
                        }
                      })
                    })
                    .on('blur', function () {
                      $(document).off('keydown.formInput')
                    })
                  // 面包屑导航点击按钮初始化
                  $('[data-jump-to]').on('click', function () {
                    var pageName = $(this).attr('data-jump-to')
                    util.nav.dispatch(pageName)
                  })
                  // icheck datetimepicker全局初始化
                  $$.inputPluginsInit($('#mainContent'))
                  // 枚举值自动填充，非首次加载
                  if (config.enumSourceState) {
                    $$.enumSourceInit($('#mainContent'))
                  }
                })
              location.hash = params.value ? route + '?' + params.value : route
              currentHash = route
              params.value = ''
              document.body.scrollTop = 0
              // for mobile
              $('body').removeClass('sidebar-open')
            })
            .each(function (index, item) {
              if (!hash) {
                if (!index) {
                  $(item).click()
                  return
                }
              } else {
                if ($(item).attr('data-gh-route') === hash) {
                  $(item).click()
                  return
                }
              }
            })

          /**
           * 获取登录用户信息
           */
          http.post(config.api.userInfo, {
            contentType: 'form'
          }, function (userInfo) {
            $('#userMenu').find('.userName').html(userInfo.name)
          })

          /**
           * 获取枚举值信息存到config中，并首次全局初始化
           */
          http.post(config.api.dictList, {
            contentType: 'form'
          }, function (enums) {
            for (var key in enums) {
              config[key] = enums[key]
            }
            $$.enumSourceInit($(document))
          })

          /**
           * 登出
           */
          $('#logout').on('click', function () {
            http.post(config.api.logout, function () {
              location.href = 'login.html'
            })
          })

          // fix select2在bootstrap modal中input无法focus的问题
          // https://github.com/select2/select2/issues/1436
          $.fn.modal.Constructor.prototype.enforceFocus = function() {}

          // fix 第二层modal退出后导致的第一层modal滚动失效问题
          // https://github.com/NodeBB/NodeBB/issues/2754
          $('#mainContent').delegate('.modal', 'hidden.bs.modal', function () {
            var firstModal = $('.modal.in:last', 'body').data('bs.modal')
            if (firstModal) {
              firstModal.$body.addClass('modal-open');
              firstModal.enforceFocus();
              firstModal.handleUpdate();
            }
          })

          // select2 i18n初始化
          $.fn.select2.defaults.set('language', 'zh-CN');

        })
      })
    </script>
  </body>
</html>
